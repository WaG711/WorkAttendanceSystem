# WorkAttendanceSystem

К вам пришел заказчик – владелец завода по производству свеч от геморроя “Здоровая
норка”. У него есть подозрения что работники постоянно опаздывают на работу или
уходят раньше. Он просит вас создать систему, которая могла бы отслеживать приход и
уход на работу каждого сотрудника.
Каждый сотрудник на проходной будет прикладывать карточку к считывателю, который
будет отправлять информацию о сотруднике в данную систему. От вас потребуется
получить номер пропуска сотрудника, найти его в базе и записать его время прохождения
КПП на вход или на выход.

# Детали реализации

1. Проект должен быть в формате ASP.NET Web API, без авторизации, визуальное
оформление (razor pages) не нужно, просто контроллеры api, принимающие данные
и (если нужно) возвращающие результат в формате JSON.
2. Необходимо создать базу сотрудников предприятия с возможностью добавления,
удаления и изменения данных сотрудников, а так же вывода списка всех
имеющихся работников. (т.е. простейший CRUD - интерфейс). Для простоты,
формат БД – Sqlite. Для создания базы понадобится EntityFramework Core 5.0 и
провайдер для Sqlite, доступный в NuGet под названием
Microsoft.EntityFrameworkCore.Sqlite.

# 1. Контроллер: HRController (отдел кадров)

1.1 Добавить сотрудника
POST /api/hr
Тело запроса:
```{
  "lastName": "Иванов",
  "firstName": "Иван",
  "middleName": "Иванович",
  "position": "Engineer"
}```

Ответ 200 OK:
```{
  "id": "guid",
  "fullName": "Иванов Иван Иванович",
  "position": "Engineer",
  "shifts": []
}```

Ошибки 400 Bad Request:
Отсутствует фамилия, имя или должность
Некорректная должность

1.2 Изменить сотрудника
PUT /api/hr/{id}
Тело запроса:
```{
  "lastName": "Петров",
  "firstName": "Пётр",
  "middleName": "Петрович",
  "position": "Manager"
}```

Ответ 200 OK: Обновлённый объект сотрудника в формате JSON.

Ошибки 400 Bad Request:
Сотрудник с указанным Id не найден
Некорректные данные

1.3 Удалить сотрудника
DELETE /api/hr/{id}
Ответ 204 No Content – успешно удалено.

Ошибки 400 Bad Request:
Сотрудник с указанным Id не найден

1.4 Получить список сотрудников
GET /api/hr?position=Engineer
Параметры запроса:
position (optional) – фильтр по должности. Если указана несуществующая должность – ошибка.
Ответ 200 OK:
```[
  {
    "id": "guid",
    "fullName": "Иванов Иван Иванович",
    "position": "Engineer",
    "monthlyWarnings": 2
  },
  ...
]```

monthlyWarnings – количество замечаний за текущий месяц (бонусная функциональность).

1.5 Получить список всех должностей
GET /api/hr/positions
Ответ 200 OK:
```[
  "Manager",
  "Engineer",
  "Candle Tester"
]```

2. Контроллер: KPPController (проходная)
2.1 Начало смены (вход)
POST /api/kpp/start
Тело запроса:
```{
  "employeeId": "guid",
  "startTime": "2025-08-30T09:05:00"
}```

Ответ 200 OK:
```{
  "id": "shift-guid",
  "startTime": "2025-08-30T09:05:00",
  "endTime": null,
  "workedHours": null,
  "employeeId": "guid"
}```

Ошибки 400 Bad Request:
Сотрудник с указанным Id не найден
Есть незавершённая предыдущая смена → нельзя начать новую

2.2 Конец смены (выход)
POST /api/kpp/end
Тело запроса:
```{
  "employeeId": "guid",
  "endTime": "2025-08-30T18:00:00"
}```

Ответ 200 OK:
```{
  "id": "shift-guid",
  "startTime": "2025-08-30T09:05:00",
  "endTime": "2025-08-30T18:00:00",
  "workedHours": 8.0,
  "employeeId": "guid"
}```

Ошибки 400 Bad Request:
Сотрудник с указанным Id не найден
Нет активной смены → нельзя завершить
Выход раньше начала смены → ошибка домена

2.3 Бизнес-правила для KPI/замечаний
Обычные сотрудники:
Приход после 09:00 → +1 предупреждение
Уход до 18:00 → +1 предупреждение
Тестировщики свечей:
Работа 12 часов
Выход до 21:00 → +1 предупреждение
